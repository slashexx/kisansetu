<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KisanSetu</title>
    <link rel="shortcut icon" href="./images/favicon.jpg" type="image/x-icon" />
    <link rel="stylesheet" href="farmers-details.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Fira+Sans:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
      integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
  </head>
  <style>
    /* From Uiverse.io by ryota1231 */
    .animated-button {
      position: relative;
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 12px 30px;
      border: 4px solid;
      border-color: transparent;
      font-size: 12px;
      /* background-color: ; */
      border-radius: 100px;
      font-weight: 600;
      color: #1f387e;
      box-shadow: 0 0 0 2px #ffffff;
      cursor: pointer;
      overflow: hidden;
      transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
    }

    .animated-button svg {
      position: absolute;
      width: 24px;
      fill: #1f387e;
      z-index: 9;
      transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1);
    }

    .animated-button .arr-1 {
      right: 16px;
    }

    .animated-button .arr-2 {
      left: -25%;
    }

    .animated-button .circle {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 20px;
      height: 20px;
      background-color: #c5e5e4;
      border-radius: 50%;
      opacity: 0;
      transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1);
    }

    .animated-button .text {
      position: relative;
      z-index: 1;
      transform: translateX(-12px);
      transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1);
    }

    .animated-button:hover {
      box-shadow: 0 0 0 12px transparent;
      color: #212121;
      border-radius: 12px;
    }

    .animated-button:hover .arr-1 {
      right: -25%;
    }

    .animated-button:hover .arr-2 {
      left: 16px;
    }

    .animated-button:hover .text {
      transform: translateX(12px);
    }

    .animated-button:hover svg {
      fill: #1f387e;
    }

    .animated-button:active {
      scale: 0.95;
      box-shadow: 0 0 0 4px greenyellow;
    }

    .animated-button:hover .circle {
      width: 220px;
      height: 220px;
      opacity: 1;
    }

    a {
      text-decoration: none;
    }

    .button {
      display: flex;
      margin-top: 50px;
      justify-content: space-between;
      width: 220px;
    }

    footer {
      background-color: #333;
      height: 100px;
      color: #fff;
      text-align: center;
      padding: 20px 0;
      left: 0;
      bottom: 0;
      width: 100%;
    }

    footer .footer-links a {
      color: #fff;
      text-decoration: none;
      margin: 0 15px;
    }

    footer .footer-links a:hover {
      text-decoration: underline;
    }

    footer p {
      margin-bottom: 25px;
    }
  </style>

  <body>
    <div class="header">
      <nav class="nav-bar">
        <a href="home-page.html">
          <img src="./images/farmer-logo.png" alt="logo" class="logo" />
        </a>
        <ul class="nav-links">
          <div class="radio-inputs">
            <label>
              <input
                class="radio-input"
                type="radio"
                name="engine"
                onclick="window.location.href='home-page.html';"
              />
              <span class="radio-tile">
                <span class="radio-icon">
                  <img
                    src="https://img.icons8.com/?size=100&id=z6m63h25vYs2&format=png&color=000000"
                    alt=""
                  />
                </span>
                <span class="radio-label">Home</span>
              </span>
            </label>
            <label>
              <input
                class="radio-input"
                type="radio"
                name="engine"
                onclick="window.location.href='farmers-page.html';"
                checked
              />
              <span class="radio-tile">
                <span class="radio-icon">
                  <img
                    src="https://img.icons8.com/?size=100&id=47584&format=png&color=000000"
                    alt=""
                  />
                </span>
                <span class="radio-label">Farmer</span>
              </span>
            </label>
            <label>
              <input
                class="radio-input"
                type="radio"
                name="engine"
                onclick="window.location.href='crops-page.html';"
              />
              <span class="radio-tile">
                <span class="radio-icon">
                  <img
                    src="https://img.icons8.com/?size=100&id=1832&format=png&color=000000"
                    alt=""
                  />
                </span>
                <span class="radio-label">Crops</span>
              </span>
            </label>
            <label>
              <input
                class="radio-input"
                type="radio"
                name="engine"
                onclick="window.location.href='about-us-page.html';"
              />
              <span class="radio-tile">
                <span class="radio-icon">
                  <img
                    src="https://img.icons8.com/?size=100&id=3439&format=png&color=000000"
                    alt=""
                  />
                </span>
                <span class="radio-label">About Us</span>
              </span>
            </label>
          </div>
        </ul>
        <div class="button">
          <a href="./signup.html">
            <button class="animated-button">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="arr-2"
                viewBox="0 0 24 24"
              >
                <path
                  d="M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"
                ></path>
              </svg>
              <span class="text">Sign Up</span>
              <span class="circle"></span>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="arr-1"
                viewBox="0 0 24 24"
              >
                <path
                  d="M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"
                ></path>
              </svg>
            </button>
          </a>
          <a href="./login.html">
            <button class="animated-button">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="arr-2"
                viewBox="0 0 24 24"
              >
                <path
                  d="M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"
                ></path>
              </svg>
              <span class="text">Login</span>
              <span class="circle"></span>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="arr-1"
                viewBox="0 0 24 24"
              >
                <path
                  d="M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"
                ></path>
              </svg>
            </button>
          </a>
        </div>
      </nav>
    </div>

    <div class="profile-container">
      <!-- Left Sidebar: Farmer Image & Verification -->
      <div class="profile-sidebar">
        <img
          src=""
          alt="Farmer Image"
          id="farmerImage"
          width="100"
          height="100"
        />
      </div>

      <!-- Right Section: Farmer Details -->
      <div class="profile-details">
        <div class="header-container">
          <h2 id="farmerName" style="display: inline-block">Farmer Name</h2>
          <button class="chatBtn" onclick="openChat()">
            <svg
              height="1.6em"
              fill="white"
              xml:space="preserve"
              viewBox="0 0 1000 1000"
              y="0px"
              x="0px"
              version="1.1"
            >
              <path
                d="M881.1,720.5H434.7L173.3,941V720.5h-54.4C58.8,720.5,10,671.1,10,610.2v-441C10,108.4,58.8,59,118.9,59h762.2C941.2,59,990,108.4,990,169.3v441C990,671.1,941.2,720.5,881.1,720.5L881.1,720.5z M935.6,169.3c0-30.4-24.4-55.2-54.5-55.2H118.9c-30.1,0-54.5,24.7-54.5,55.2v441c0,30.4,24.4,55.1,54.5,55.1h54.4h54.4v110.3l163.3-110.2H500h381.1c30.1,0,54.5-24.7,54.5-55.1V169.3L935.6,169.3z M717.8,444.8c-30.1,0-54.4-24.7-54.4-55.1c0-30.4,24.3-55.2,54.4-55.2c30.1,0,54.5,24.7,54.5,55.2C772.2,420.2,747.8,444.8,717.8,444.8L717.8,444.8z M500,444.8c-30.1,0-54.4-24.7-54.4-55.1c0-30.4,24.3-55.2,54.4-55.2c30.1,0,54.4,24.7,54.4,55.2C554.4,420.2,530.1,444.8,500,444.8L500,444.8z M282.2,444.8c-30.1,0-54.5-24.7-54.5-55.1c0-30.4,24.4-55.2,54.5-55.2c30.1,0,54.4,24.7,54.4,55.2C336.7,420.2,312.3,444.8,282.2,444.8L282.2,444.8z"
              ></path>
            </svg>
            <span class="tooltip">Chat</span>
          </button>

          <!-- You can replace this with an SVG or font icon -->
          <button
            class="chatBtn"
            onclick="window.location.href = '/contract-form'"
          >
            <svg
              class="icon-cart"
              viewBox="0 0 24.38 30.52"
              height="30.52"
              width="24.38"
              xmlns="http://www.w3.org/2000/svg"
            >
              <title>icon-cart</title>
              <path
                transform="translate(-3.62 -0.85)"
                d="M28,27.3,26.24,7.51a.75.75,0,0,0-.76-.69h-3.7a6,6,0,0,0-12,0H6.13a.76.76,0,0,0-.76.69L3.62,27.3v.07a4.29,4.29,0,0,0,4.52,4H23.48a4.29,4.29,0,0,0,4.52-4ZM15.81,2.37a4.47,4.47,0,0,1,4.46,4.45H11.35a4.47,4.47,0,0,1,4.46-4.45Zm7.67,27.48H8.13a2.79,2.79,0,0,1-3-2.45L6.83,8.34h3V11a.76.76,0,0,0,1.52,0V8.34h8.92V11a.76.76,0,0,0,1.52,0V8.34h3L26.48,27.4a2.79,2.79,0,0,1-3,2.44Zm0,0"
              ></path>
            </svg>
            <span class="tooltip">Buy</span>
          </button>
        </div>

        <!-- Tabs for different sections -->
        <div class="tabs">
          <div class="tab active" data-tab="general-info">General Info</div>
          <div class="tab" data-tab="crop-info">Crops Grown</div>
        </div>

        <!-- Tab Content for General Info -->
        <div class="tab-content active" id="general-info">
          <p><strong>State:</strong> <span id="farmerState"></span></p>
          <p>
            <strong>Postal Code:</strong> <span id="farmerPostalCode"></span>
          </p>
          <p><strong>Address:</strong> <span id="farmerAddress"></span></p>
        </div>

        <h2>Make payment :</h2>
        <div style="display: ruby">
          <button class="chatBtn" onclick="openChat()" style="margin: 20px">
            <svg fill="#8a41d2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke="#8a41d2"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M13.479 9.883c-1.626-.604-2.512-1.067-2.512-1.803 0-.622.511-.977 1.423-.977 1.667 0 3.379.642 4.558 1.22l.666-4.111c-.935-.446-2.847-1.177-5.49-1.177-1.87 0-3.425.489-4.536 1.401-1.155.954-1.757 2.334-1.757 4 0 3.023 1.847 4.312 4.847 5.403 1.936.688 2.579 1.178 2.579 1.934 0 .732-.629 1.155-1.762 1.155-1.403 0-3.716-.689-5.231-1.578l-.674 4.157c1.304.732 3.705 1.488 6.197 1.488 1.976 0 3.624-.467 4.735-1.356 1.245-.977 1.89-2.422 1.89-4.289 0-3.091-1.889-4.38-4.935-5.468h.002z"></path></g></svg>
            </svg>
            <span class="tooltip">Stripe</span>
          </button>

          <button class="chatBtn" onclick="window.location.href='/secure/sendeth'">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 507.83 470.86"><defs><style>.a{fill:#e2761b;stroke:#e2761b;}.a,.b,.c,.d,.e,.f,.g,.h,.i,.j{stroke-linecap:round;stroke-linejoin:round;}.b{fill:#e4761b;stroke:#e4761b;}.c{fill:#d7c1b3;stroke:#d7c1b3;}.d{fill:#233447;stroke:#233447;}.e{fill:#cd6116;stroke:#cd6116;}.f{fill:#e4751f;stroke:#e4751f;}.g{fill:#f6851b;stroke:#f6851b;}.h{fill:#c0ad9e;stroke:#c0ad9e;}.i{fill:#161616;stroke:#161616;}.j{fill:#763d16;stroke:#763d16;}</style></defs><title>metamask</title><polygon class="a" points="482.09 0.5 284.32 147.38 320.9 60.72 482.09 0.5"/><polygon class="b" points="25.54 0.5 221.72 148.77 186.93 60.72 25.54 0.5"/><polygon class="b" points="410.93 340.97 358.26 421.67 470.96 452.67 503.36 342.76 410.93 340.97"/><polygon class="b" points="4.67 342.76 36.87 452.67 149.57 421.67 96.9 340.97 4.67 342.76"/><polygon class="b" points="143.21 204.62 111.8 252.13 223.7 257.1 219.73 136.85 143.21 204.62"/><polygon class="b" points="364.42 204.62 286.91 135.46 284.32 257.1 396.03 252.13 364.42 204.62"/><polygon class="b" points="149.57 421.67 216.75 388.87 158.71 343.55 149.57 421.67"/><polygon class="b" points="290.88 388.87 358.26 421.67 348.92 343.55 290.88 388.87"/><polygon class="c" points="358.26 421.67 290.88 388.87 296.25 432.8 295.65 451.28 358.26 421.67"/><polygon class="c" points="149.57 421.67 212.18 451.28 211.78 432.8 216.75 388.87 149.57 421.67"/><polygon class="d" points="213.17 314.54 157.12 298.04 196.67 279.95 213.17 314.54"/><polygon class="d" points="294.46 314.54 310.96 279.95 350.71 298.04 294.46 314.54"/><polygon class="e" points="149.57 421.67 159.11 340.97 96.9 342.76 149.57 421.67"/><polygon class="e" points="348.72 340.97 358.26 421.67 410.93 342.76 348.72 340.97"/><polygon class="e" points="396.03 252.13 284.32 257.1 294.66 314.54 311.16 279.95 350.91 298.04 396.03 252.13"/><polygon class="e" points="157.12 298.04 196.87 279.95 213.17 314.54 223.7 257.1 111.8 252.13 157.12 298.04"/><polygon class="f" points="111.8 252.13 158.71 343.55 157.12 298.04 111.8 252.13"/><polygon class="f" points="350.91 298.04 348.92 343.55 396.03 252.13 350.91 298.04"/><polygon class="f" points="223.7 257.1 213.17 314.54 226.29 382.31 229.27 293.07 223.7 257.1"/><polygon class="f" points="284.32 257.1 278.96 292.87 281.34 382.31 294.66 314.54 284.32 257.1"/><polygon class="g" points="294.66 314.54 281.34 382.31 290.88 388.87 348.92 343.55 350.91 298.04 294.66 314.54"/><polygon class="g" points="157.12 298.04 158.71 343.55 216.75 388.87 226.29 382.31 213.17 314.54 157.12 298.04"/><polygon class="h" points="295.65 451.28 296.25 432.8 291.28 428.42 216.35 428.42 211.78 432.8 212.18 451.28 149.57 421.67 171.43 439.55 215.75 470.36 291.88 470.36 336.4 439.55 358.26 421.67 295.65 451.28"/><polygon class="i" points="290.88 388.87 281.34 382.31 226.29 382.31 216.75 388.87 211.78 432.8 216.35 428.42 291.28 428.42 296.25 432.8 290.88 388.87"/><polygon class="j" points="490.44 156.92 507.33 75.83 482.09 0.5 290.88 142.41 364.42 204.62 468.37 235.03 491.43 208.2 481.49 201.05 497.39 186.54 485.07 177 500.97 164.87 490.44 156.92"/><polygon class="j" points="0.5 75.83 17.39 156.92 6.66 164.87 22.56 177 10.44 186.54 26.34 201.05 16.4 208.2 39.26 235.03 143.21 204.62 216.75 142.41 25.54 0.5 0.5 75.83"/><polygon class="g" points="468.37 235.03 364.42 204.62 396.03 252.13 348.92 343.55 410.93 342.76 503.36 342.76 468.37 235.03"/><polygon class="g" points="143.21 204.62 39.26 235.03 4.67 342.76 96.9 342.76 158.71 343.55 111.8 252.13 143.21 204.62"/><polygon class="g" points="284.32 257.1 290.88 142.41 321.1 60.72 186.93 60.72 216.75 142.41 223.7 257.1 226.09 293.27 226.29 382.31 281.34 382.31 281.74 293.27 284.32 257.1"/></svg>
            <span class="tooltip">Zetachain</span>
          </button>
        </div>
        <br />

        <!-- Tab Content for Crop Info -->
        <div class="tab-content" id="crop-info">
          <p><strong>Crops Grown:</strong> <span id="farmerCrops"></span></p>
        </div>

        <div class="swiper mySwiper hide">
          <div class="swiper-wrapper"></div>
          <div class="swiper-button-next"></div>
          <div class="swiper-button-prev"></div>
          <!-- <div class="swiper-pagination"></div> -->
        </div>

        <!-- Back Button -->
        <a href="farmers-page.html" class="back-btn">Back to List</a>
      </div>
    </div>
    <footer>
      <p>&copy; 2024 KisanSetu. All Rights Reserved.</p>
      <div class="footer-links">
        <a href="home-page.html">Home</a>
        <a href="about-us-page.html">About</a>
        <a href="#">Contact</a>
      </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <!-- <script src="./farmers-details-details.js"></script> -->
    <script type="module">
      import {
        getAuth,
        signInWithEmailAndPassword,
        createUserWithEmailAndPassword,
        GoogleAuthProvider,
      } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";
      import {
        getFirestore,
        doc,
        setDoc,
        getDoc,
        query,
        collection,
        where,
        getDocs,
      } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";

      const firebaseConfig = {
        apiKey: "AIzaSyBNrhwRH5TeqAPyXmToaCGJ6St4g1FKOno",
        authDomain: "kisansetu-1640.firebaseapp.com",
        projectId: "kisansetu-1640",
        storageBucket: "kisansetu-1640.appspot.com",
        messagingSenderId: "763552320675",
        appId: "1:763552320675:web:93cff2382387b7b5dc4316",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);
      const googleProvider = new GoogleAuthProvider();

      const cropsImages = {
        wheat:
          "https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcTb0GgH3ccFLjH8ZPZxa9DKvjZ4uOgErcTs1fzGKugcyuKlE6ri",
        rice: "https://cdn.britannica.com/89/140889-050-EC3F00BF/Ripening-heads-rice-Oryza-sativa.jpg",
        Jowar:
          "https://i0.wp.com/www.svaguna.com/wp-content/uploads/2019/08/Jowar.jpg?fit=600%2C400&ssl=1",
        bajra:
          "https://karthickorganics.com/wp-content/uploads/2023/11/bajra.webp",
        chickpeas:
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSI2UdrUCYD-xy6Fherf3RMmzBbjBklVKPR-A&s",
        "Mung Beans":
          "https://cdn.britannica.com/12/158012-050-F79D3126/mung-beans-dishes-desserts-soups.jpg",
        peas: "https://media.post.rvohealth.io/wp-content/uploads/2020/09/green-peas-thumb-1-732x549.jpg",
        ragi: "https://5.imimg.com/data5/SELLER/Default/2022/9/ZB/GS/FR/25008022/jiwa-organic-ragi-flour.jpg",
        maize:
          "https://5.imimg.com/data5/BB/IW/MY-28079104/organic-yellow-maize.jpg",
        millets:
          "https://sonkan.in/wp-content/uploads/2023/09/From-Farm-to-Table_-Tracing-the-Journey-of-Millets-in-Indian-Markets-930x614.webp",
        barley:
          "https://cdn-prod.medicalnewstoday.com/content/images/articles/295/295268/barley-grains-in-a-wooden-bowl.jpg",
        grapes:
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQTUNelf6LWd4fNNrJDDXZRgxv9n4JnMDkx3Q&s",
      };
      // Function to get query parameters
      function getQueryParam(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
      }

      let farmers = [];

      // Function to display farmer details based on ID from the query parameter
      async function displayFarmerDetails() {
        const farmerId = getQueryParam("farmerId");

        if (farmerId) {
          try {
            // Firebase data fetch
            const docRef = doc(db, "users", farmerId);
            const docSnap = await getDoc(docRef);

            let farmerDetails;
            if (docSnap.exists()) {
              farmerDetails = docSnap.data(); // Firebase data
            } else {
              // Fallback to local JSON data if Firebase fails
              farmerDetails = farmers.find(
                (farmer) => farmer.farmerId == parseInt(farmerId)
              );
            }

            if (farmerDetails) {
              document.getElementById("farmerName").innerText =
                farmerDetails.name;
              document.getElementById("farmerImage").src =
                farmerDetails.image || "";
              document.getElementById("farmerState").innerText =
                farmerDetails.state || "N/A";
              document.getElementById("farmerPostalCode").innerText =
                farmerDetails.postalCode || "N/A";
              document.getElementById("farmerAddress").innerText =
                farmerDetails.address || "N/A";

              // Handle crops
              const farmerCrops = document.getElementById("farmerCrops");
              farmerCrops.innerHTML = farmerDetails.cropsGrown
                .map((crop) => `<li>${crop}</li>`)
                .join("");

              // Swiper logic for images
              const swiperContainer = document.querySelector(".swiper-wrapper");
              swiperContainer.innerHTML = farmerDetails.cropsGrown
                .map(
                  (crop) => `
          <div class="swiper-slide">
            <div class="title" data-swiper-parallax="-300">${crop}</div>
            <img src="${cropsImages[crop.toLowerCase()]}" alt="${crop}" />
          </div>`
                )
                .join("");

              new Swiper(".mySwiper", {
                slidesPerView: 1,
                spaceBetween: 30,
                loop: true,
                navigation: {
                  nextEl: ".swiper-button-next",
                  prevEl: ".swiper-button-prev",
                },
              });
            } else {
              document.querySelector(".profile-details").textContent =
                "Farmer not found.";
            }
          } catch (error) {
            console.error("Error fetching farmer details:", error);
            document.querySelector(".profile-details").textContent =
              "Error fetching farmer details.";
          }
        } else {
          document.querySelector(".profile-details").textContent =
            "No farmer selected.";
        }
      }

      // Fetch the data and initialize
      fetch("./farmers-details.json")
        .then((response) => response.json())
        .then((data) => {
          farmers = data;
          displayFarmerDetails();
        })
        .catch((error) =>
          console.error("Error fetching the JSON file:", error)
        );

      const dealBtn = document.querySelector(".deal");
      const farmerId = getQueryParam("farmerId");
      const userId = localStorage.getItem("uid");

      function contractRedirect() {
        window.location.href = `/contract-form`;
      }

      // Handle tab switching
      document.querySelectorAll(".tab").forEach((tab) => {
        tab.addEventListener("click", function () {
          document
            .querySelectorAll(".tab")
            .forEach((t) => t.classList.remove("active"));
          this.classList.add("active");

          const tabId = this.getAttribute("data-tab");
          document
            .querySelectorAll(".tab-content")
            .forEach((content) => content.classList.remove("active"));
          document.getElementById(tabId).classList.add("active");
          let swiperContainer = document.getElementsByClassName("swiper")[0];
          swiperContainer.classList.toggle("hide");
        });
      });

      // Chat button handler
      async function openChat() {
        const userId = localStorage.getItem("uid");
        if (userId) {
          const farmerId = getQueryParam("farmerId");
          try {
            const response = await fetch(`/chat/${userId}`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ farmerId, userId }),
            });

            if (!response.ok) throw new Error("Network response was not ok.");
            const data = await response.json();
            console.log("Server response:", data);
            window.location.href = `/chat/${userId}`;
          } catch (error) {
            console.error("Error:", error);
            alert("An error occurred while sending data.");
          }
        } else {
          alert("User ID not found. Please log in.");
        }
      }
    </script>
  </body>
</html>
